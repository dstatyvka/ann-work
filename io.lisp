(in-package :number-one)

(defun process-file (fname &optional (threshold 100))
  (with-image-from-file (*default-image* fname)
    (let (xs ys)
      (do-intensities (int x y)
	(when (< threshold int)
	  (push x xs)
	  (push y ys)))
      (list (make-marray '(unsigned-byte 16) :initial-contents xs)
	    (make-marray '(unsigned-byte 16) :initial-contents ys)))))